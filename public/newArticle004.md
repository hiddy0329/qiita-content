---
title: コンピュータサイエンス学び直し - 変数の参照渡しと値渡しについて -
tags:
  - cs
  - コンピューターサイエンス
  - エンジニア
private: false
updated_at: '2025-04-10T09:55:53+09:00'
id: c20ca8ab7a2d01a4bbad
organization_url_name: null
slide: false
ignorePublish: false
---
# 1. はじめに
エンジニアとして3年が経過しようとしている中、技術を使ってより高度な問題解決をしていくためには、フレームワークや言語に依存しない基礎となる知識が必要だと感じたため、CSを勉強し直しています。
その学習内容を備忘録として発信します。
前回「**変数**」に関する記事を投稿しましたが、今回はその中でも**変数の参照渡しと値渡し**という部分についてです。

# 2. 話の進め方

プログラミングにおいて「変数の扱い方」は非常に重要な概念です。
プログラムがデータを扱う際、言語ごとにどのような変数の扱い方をするかによってパフォーマンスなどに影響が出てきますので理解しておくことは重要です。
まず、「**値渡しと参照渡しとは何か**」について説明し、その後「**言語ごとにどう違うのか**」という順番で解説を進めます。

# 3. 値渡しとは

## 値渡し（Pass by Value）
値渡しとは、関数に引数を渡すときに、その変数の「**値そのものをコピー**」して渡す方法です。
そのため、**関数内で値を変更しても、元の変数には影響を与えません。**

## 特徴
- 元の変数に影響を与えない（コピーを操作するため）。
- 主に基本データ型（プリミティブ型）で使用される。
- メモリの消費が増える（コピーを作成するため）。
- 安全だが、大きなデータ構造には非効率的。

```python
例（Python - 値渡し）
def modify_value(x):
    x = 10  # 新しい値を代入
    print("関数内の x:", x)

a = 5
modify_value(a)
print("関数外の a:", a)  # 元の変数 a は変わらない
```

出力

```python
関数内の x: 10
関数外の a: 5
→ modify_value 関数の x は、a のコピーを受け取るので、関数内で変更しても a には影響なし。
```

# 4. 参照渡しとは

## 参照渡し（Pass by Reference）
参照渡しとは、変数の「**参照（アドレス）を渡す**」方法です。
そのため、**関数内で値を変更すると、元の変数にも影響を与えます。**

## 特徴
- 元の変数が変更される可能性がある。
- 主にオブジェクト型（リスト、辞書、クラスのインスタンスなど）で使用される。
- メモリ効率が良い（コピーを作らない）。
- 意図しない変更が起こるリスクがある。

```python
例（Python - 参照渡し）
def modify_list(lst):
    lst.append(4)  # リストに値を追加
    print("関数内の lst:", lst)

my_list = [1, 2, 3]
modify_list(my_list)
print("関数外の my_list:", my_list)  # 元のリストが変更される
```

出力

```python
関数内の lst: [1, 2, 3, 4]
関数外の my_list: [1, 2, 3, 4]
→ my_list の参照が渡されるため、関数内でリストを変更すると元の変数も変更される。
```

# 5. 値渡しと参照渡しの使い分け

| 項目             | 値渡し                                   | 参照渡し                                 |
|------------------|-------------------------------------------|-------------------------------------------|
| 適用対象         | 基本データ型（整数、文字列）             | オブジェクト（リスト、辞書など）         |
| 元の変数に影響   | なし                                     | あり                                     |
| メモリ効率       | 低い（コピーが作られる）                 | 高い（コピーを作らない）                 |
| 安全性           | 高い（副作用なし）                       | 低い（意図しない変更のリスク）           |

## どちらを使うべきか？

- 元のデータを変更したくない → 値渡し
- 効率を重視する・変更を加えたい → 参照渡し

# 6. 言語ごとの違い

| 言語         | プリミティブ型（整数・文字列など）         | 配列・リスト                               | オブジェクト（クラスのインスタンスなど）        | ポインタの概念                       |
|--------------|--------------------------------------------|--------------------------------------------|--------------------------------------------------|------------------------------------|
| PHP          | 値渡し（デフォルト）                       | 参照渡し（オブジェクト同様）               | 参照渡し（クラスのインスタンス）                | `&` を使えば参照渡しが可能         |
| Ruby         | 値渡し（イミュータブルなオブジェクト）     | 参照渡し                                   | 参照渡し                                         | なし                               |
| Python       | 値渡し（イミュータブルなオブジェクト）     | 参照渡し                                   | 参照渡し                                         | なし                               |
| Java         | 値渡し（プリミティブ型）                   | 参照渡し（配列はオブジェクト）             | 参照の「値渡し」（参照のコピーを渡す）           | なし                               |
| C            | 値渡し                                     | 配列のポインタを渡す（実質参照渡し）       | ポインタを使えば参照渡しが可能                   | あり（明示的に `*`, `&` を使用）   |
| JavaScript   | 値渡し（プリミティブ型）                   | 参照渡し                                   | 参照渡し                                         | なし                               |

## ポイント
- PHP は「&」を使うと明示的に参照渡しが可能。
- Ruby・Python はオブジェクト指向が強く、**基本的にすべてのオブジェクトが参照渡し。**
- Java は「オブジェクトの参照のコピーを値渡し」するため、厳密には参照渡しとは異なる。
- C ではポインタを使うことで参照渡しが可能。
- JavaScript はオブジェクトや配列が参照渡しで、プリミティブ型は値渡し。

# 7. （おまけ）RubyとPythonについて 

RubyとPythonは特にオブジェクト指向の強い言語のため、変数の扱いが他と違う部分が多いです。
RubyやPythonでは、**すべてのデータがオブジェクト**として扱われます。
そして、**変数は値そのものではなく、オブジェクトへの参照（アドレス）を保持する仕組み**になっています。

## 実際の動作

### 整数や文字列などのイミュータブル（変更不可）なオブジェクト

参照は渡されるが、変更できないため「値渡しのように動作」する。

- 例：整数 (int)、文字列 (str)、タプル (tuple) など。

### リストや辞書などのミュータブル（変更可能）なオブジェクト

参照が渡されるため、関数内で変更すると元のオブジェクトも変更される。

- 例：リスト (list)、辞書 (dict)、オブジェクト（class のインスタンス）。

## 例で理解する

### Pythonの場合

```python
def modify_value(x):
    x = 10  # 新しい整数オブジェクトを作成
    print("関数内の x:", x)

a = 5
modify_value(a)
print("関数外の a:", a)  # 元の変数 a は変わらない
```

出力

```python
関数内の x: 10
関数外の a: 5
int はイミュータブルなので、関数内で x = 10 とすると新しいオブジェクトが作られる（元の a には影響なし）。
```

#### リスト（ミュータブル）を渡す場合
```python
def modify_list(lst):
    lst.append(4)  # リストを変更
    print("関数内の lst:", lst)

my_list = [1, 2, 3]
modify_list(my_list)
print("関数外の my_list:", my_list)  # 変更されている！
```

出力

```python
関数内の lst: [1, 2, 3, 4]
関数外の my_list: [1, 2, 3, 4]
list はミュータブルなので、関数内で変更すると元の変数も変わる（参照渡しのように動作）。
```

### Rubyの場合

Rubyも同じように、基本的にすべてのデータはオブジェクトで、変数は参照を保持します。

```ruby
def modify_value(x)
  x = 10  # 新しいオブジェクトを作成
  puts "関数内の x: #{x}"
end

a = 5
modify_value(a)
puts "関数外の a: #{a}"  # 元の変数 a は変わらない
```

出力

```ruby
関数内の x: 10
関数外の a: 5
→ x = 10 にすると、新しいオブジェクト 10 への参照に切り替わるため、元の a には影響なし。
```

#### 配列（ミュータブル）を渡す場合
```ruby
def modify_array(arr)
  arr << 4  # 配列に要素を追加
  puts "関数内の arr: #{arr}"
end

my_array = [1, 2, 3]
modify_array(my_array)
puts "関数外の my_array: #{my_array}"  # 変更されている！
```

出力
```ruby
関数内の arr: [1, 2, 3, 4]
関数外の my_array: [1, 2, 3, 4]
→ Array はミュータブルなので、関数内で変更すると元の変数も変更される。
```

# 8. まとめ

しっかりと調べてみると、言語ごとに変数の扱い方が異なり、パフォーマンスへの影響もそれぞれ異なってくるということが分かりました。こうした言語仕様をしっかりと理解した上でプログラミングをするという一段上のレベルを目指していきたいです。
